<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PDFTextWritter.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">citizensLoader4a</a> &gt; <a href="index.source.html" class="el_package">es.uniovi.asw.personalletter</a> &gt; <span class="el_source">PDFTextWritter.java</span></div><h1>PDFTextWritter.java</h1><pre class="source lang-java linenums">package es.uniovi.asw.personalletter;

import com.lowagie.text.Document;
import com.lowagie.text.DocumentException;
import com.lowagie.text.Font;
import com.lowagie.text.Paragraph;
import com.lowagie.text.pdf.PdfWriter;
import es.uniovi.asw.util.exception.CitizenException;

import java.io.FileNotFoundException;
import java.io.FileOutputStream;

/**
 * Escritor de cartas PDF
 */
<span class="fc" id="L16">class PDFTextWritter implements TextWritter {</span>

<span class="fc" id="L18">	private static String FILE_PATH = &quot;src/test/resources/&quot;;</span>
<span class="fc" id="L19">	private static Font catFont = new Font(Font.TIMES_ROMAN, 18, Font.BOLD);</span>
	/*private static Font redFont = new Font(Font.TIMES_ROMAN, 12, Font.NORMAL);
	private static Font subFont = new Font(Font.TIMES_ROMAN, 16, Font.BOLD);
	private static Font smallBold = new Font(Font.TIMES_ROMAN, 12, Font.BOLD);
*/
	@Override
	public void createDocument(String documentName, String content) throws CitizenException {
<span class="fc" id="L26">		String realPath = FILE_PATH + documentName + &quot;.pdf&quot;;</span>
<span class="fc" id="L27">		Document doc = new Document();</span>
		try {
<span class="fc" id="L29">			PdfWriter.getInstance(doc, new FileOutputStream(realPath));</span>
<span class="fc" id="L30">			doc.open();</span>
<span class="fc" id="L31">			addMetaData(doc);</span>
<span class="fc" id="L32">			addTitlePage(doc);</span>
<span class="fc" id="L33">			addContent(doc, content);</span>
<span class="nc" id="L34">		} catch (DocumentException | FileNotFoundException e) {</span>
<span class="nc" id="L35">			throw new CitizenException(&quot;Error al generar documento pdf&quot; +</span>
<span class="nc" id="L36">					&quot; [&quot;+ FILE_PATH+documentName+&quot;.pdf] | [&quot;+this.getClass().getName()+&quot;]&quot;);</span>
		} finally {
<span class="pc bpc" id="L38" title="3 of 4 branches missed.">			if (doc != null) {</span>
<span class="pc" id="L39">				doc.close();</span>
			}
		}

<span class="fc" id="L43">	}</span>

	/**
	 * Metadata del documento.
	 * @param document Documento en cuestión
	 */
	private void addMetaData(Document document) {
<span class="fc" id="L50">		document.addTitle(&quot;My first PDF&quot;);</span>
<span class="fc" id="L51">		document.addSubject(&quot;Using iText&quot;);</span>
<span class="fc" id="L52">		document.addKeywords(&quot;Java, PDF, iText&quot;);</span>
<span class="fc" id="L53">		document.addAuthor(&quot;Lars Vogel&quot;);</span>
<span class="fc" id="L54">		document.addCreator(&quot;Lars Vogel&quot;);</span>
<span class="fc" id="L55">	}</span>
	/**
	 * Título del documento.
	 * @param document Documento en cuestión
	 * @throws DocumentException Excepcion generada por algún problema
	 */
	private void addTitlePage(Document document) throws DocumentException {
<span class="fc" id="L62">		Paragraph preface = new Paragraph();</span>
<span class="fc" id="L63">		addEmptyLine(preface, 1);</span>
<span class="fc" id="L64">		preface.add(new Paragraph(&quot;CitizensLoader PDF&quot;, catFont));</span>
		
//		addEmptyLine(preface, 1);
//		// Will create: Report generated by: _name, _date
//		preface.add(new Paragraph(&quot;Report generated by: &quot; + System.getProperty(&quot;user.name&quot;) + &quot;, &quot; + new Date(), //$NON-NLS-1$ //$NON-NLS-2$ //$NON-NLS-3$
//				smallBold));
//		addEmptyLine(preface, 3);
//		preface.add(new Paragraph(&quot;This document describes something which is very important &quot;, smallBold));
//
//		addEmptyLine(preface, 8);
//
//		preface.add(new Paragraph(
//				&quot;This document is a preliminary version and not subject to your license agreement or any other agreement with vogella.com ;-).&quot;,
//				redFont));
//
//		document.add(preface);
//		// Start a new page
//		document.newPage();
<span class="fc" id="L82">		document.add(preface);</span>
<span class="fc" id="L83">		addEmptyLine(preface, 2);</span>
<span class="fc" id="L84">	}</span>

	private void addContent(Document document, String content) throws DocumentException {
//		Anchor anchor = new Anchor(&quot;First Chapter&quot;, catFont);
//		anchor.setName(&quot;First Chapter&quot;);

//		// Second parameter is the number of the chapter
//		Chapter catPart = new Chapter(new Paragraph(anchor), 1);
//
//		Paragraph subPara = new Paragraph(&quot;Subcategory 1&quot;, subFont);
//		Section subCatPart = catPart.addSection(subPara);
//		subCatPart.add(new Paragraph(&quot;Hello&quot;));
//
//		subPara = new Paragraph(&quot;Subcategory 2&quot;, subFont);
//		subCatPart = catPart.addSection(subPara);
//		subCatPart.add(new Paragraph(&quot;Paragraph 1&quot;));
//		subCatPart.add(new Paragraph(&quot;Paragraph 2&quot;));
//		subCatPart.add(new Paragraph(&quot;Paragraph 3&quot;));
		/*
		// add a list
		createList(subCatPart);
		Paragraph paragraph = new Paragraph();
		addEmptyLine(paragraph, 5);
		subCatPart.add(paragraph);

		// add a table
		createTable(subCatPart);

		// now add all this to the document
		document.add(catPart);

		// Next section
		anchor = new Anchor(&quot;Second Chapter&quot;, catFont);
		anchor.setName(&quot;Second Chapter&quot;);

		// Second parameter is the number of the chapter
		catPart = new Chapter(new Paragraph(anchor), 1);

		subPara = new Paragraph(&quot;Subcategory&quot;, subFont);
		subCatPart = catPart.addSection(subPara);
		subCatPart.add(new Paragraph(&quot;This is a very important message&quot;));
	*/
		// now add all this to the document
<span class="fc" id="L127">		Paragraph paragraph = new Paragraph(content);</span>
		
<span class="fc" id="L129">		document.add(paragraph);</span>

<span class="fc" id="L131">	}</span>
	/*
	private void createTable(Section subCatPart) throws BadElementException {
		PdfPTable table = new PdfPTable(3);

		// t.setBorderColor(BaseColor.GRAY);
		// t.setPadding(4);
		// t.setSpacing(4);
		// t.setBorderWidth(1);

		PdfPCell c1 = new PdfPCell(new Phrase(&quot;Table Header 1&quot;));
		c1.setHorizontalAlignment(Element.ALIGN_CENTER);
		table.addCell(c1);

		c1 = new PdfPCell(new Phrase(&quot;Table Header 2&quot;));
		c1.setHorizontalAlignment(Element.ALIGN_CENTER);
		table.addCell(c1);

		c1 = new PdfPCell(new Phrase(&quot;Table Header 3&quot;));
		c1.setHorizontalAlignment(Element.ALIGN_CENTER);
		table.addCell(c1);
		table.setHeaderRows(1);

		table.addCell(&quot;1.0&quot;);
		table.addCell(&quot;1.1&quot;);
		table.addCell(&quot;1.2&quot;);
		table.addCell(&quot;2.1&quot;);
		table.addCell(&quot;2.2&quot;);
		table.addCell(&quot;2.3&quot;);

		subCatPart.add(table);

	}

	private void createList(Section subCatPart) {
		List list = new List(true, false, 10);
		list.add(new ListItem(&quot;First point&quot;));
		list.add(new ListItem(&quot;Second point&quot;));
		list.add(new ListItem(&quot;Third point&quot;));
		subCatPart.add(list);
	}
	*/

	private void addEmptyLine(Paragraph paragraph, int number) {
<span class="fc bfc" id="L175" title="All 2 branches covered.">		for (int i = 0; i &lt; number; i++) {</span>
<span class="fc" id="L176">			paragraph.add(new Paragraph(&quot; &quot;));</span>
		}
<span class="fc" id="L178">	}</span>


}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>